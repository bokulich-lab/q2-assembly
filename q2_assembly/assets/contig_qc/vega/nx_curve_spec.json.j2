{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "params": [
    {"name": "category_param", "value": "group"},
    {"name": "value_param", "value": "All"}
  ],
  "description": "Nx curve per sample",
  "data": {"values": {{ nx_df | safe }}},
  "transform": [{"filter": "value_param == 'All' || datum[category_param] == value_param"}],
  "mark": {"type": "line", "point": true},
  "width": "container", "height": 350,
  "selection": {
    "sample_select": {
      "type": "multi",
      "fields": ["sample"],
      "bind": "legend"
    },
    "grid": {"type": "interval", "bind": "scales"}
  },
  "encoding": {
    "x": {"field": "percent", "type": "quantitative", "title": "Percent of assembly (Nx)"},
    "y": {"field": "nx", "type": "quantitative", "title": "Contig size (bp)", "axis": {"format": "~s"}},
    "color": {"field": "sample", "type": "nominal", "scale": {"scheme": "viridis"}},
    "opacity": {
      "condition": {"param": "sample_select", "value": 1},
      "value": 0.2
    }
  },
  "config": {
    "background": "#fff",
    "font": "Open Sans, Arial, sans-serif",
    "axis": {
      "grid": true,
      "gridColor": "#eaeaea",
      "gridWidth": 1,
      "tickColor": "#888",
      "labelFont": "Open Sans, Arial, sans-serif",
      "labelFontSize": 14,
      "titleFont": "Open Sans, Arial, sans-serif",
      "titleFontSize": 16,
      "titleFontWeight": "bold",
      "domain": false
    },
    "legend": {
      "orient": "top",
      "columns": {{ n_cols }},
      "title": "Sample",
      "padding": 10,
      "labelFont": "Open Sans, Arial, sans-serif",
      "labelFontSize": 14,
      "titleFont": "Open Sans, Arial, sans-serif",
      "titleFontSize": 15,
      "symbolType": "circle",
      "symbolSize": 120,
      "symbolLimit": 100
    },
    "view": {
      "stroke": "#eaeaea",
      "strokeWidth": 1
    },
    "title": {
      "font": "Open Sans, Arial, sans-serif",
      "fontSize": 18,
      "fontWeight": "bold",
      "anchor": "middle",
      "color": "#222"
    }
  },
  "title": "Nx curve"
} 